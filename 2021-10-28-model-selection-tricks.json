{"version":2,"kind":"Article","sha256":"4e0b61f565c395a6a1224d3b2b79d9a1f60799de41a3e2c8f35034901df8a608","slug":"2021-10-28-model-selection-tricks","location":"/CS4780/2021-10-28-Model-Selection-Tricks.md","dependencies":[],"frontmatter":{"title":"Model Selection Tricks","date":"2021-10-28","authors":[{"nameParsed":{"literal":"Yao Lirong","given":"Yao","family":"Lirong"},"name":"Yao Lirong","affiliations":["Cornell University"],"url":"https://yao-lirong.github.io","linkedin":"https://www.linkedin.com/in/yao-lirong/","id":"contributors-myst-generated-uid-0"}],"keywords":["Cornell","CS","Yao Lirong"],"affiliations":[{"id":"Cornell University","name":"Cornell University"}],"numbering":{"title":{"offset":1}},"thumbnail":"/cornell-notes/build/643c4fcd86a736a95208145a3a53f8ee.png","exports":[{"format":"md","filename":"2021-10-28-Model-Selection-Tricks.md","url":"/cornell-notes/build/2021-10-28-Model-Sel-f6d9c7d019c2eb42cc3cefb86db0f2c2.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Overfitting and Underfitting","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Qt7j8sBwaC"}],"identifier":"overfitting-and-underfitting","label":"Overfitting and Underfitting","html_id":"overfitting-and-underfitting","implicit":true,"key":"iDP2GHMUae"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"There are two problematic cases which can arise when learning a classifier on a data set: underfitting and overfitting, each of which relate to the degree to which the data in the training set is extrapolated to apply to unknown data:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jAkXoQ6VER"}],"key":"gZZSgyBXWJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Underfitting","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"c0Mb4PjNv8"}],"key":"pNWHOOYdej"},{"type":"text","value":": The classifier learned on the training set is not expressive enough (i.e. too simple) to even account for the data provided. In this case, both the training error and the test error will be high, as the classifier does not account for relevant information present in the training set.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kVickJ5ngx"}],"key":"fdWpBQq8u1"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Overfitting","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"bJcPJIuF0n"}],"key":"trsB4v8Hhd"},{"type":"text","value":": The classifier learned on the training set is too specific, and cannot be used to accurately infer anything about unseen data. Although training error continues to decrease over time, test error will begin to increase again as the classifier begins to make decisions based on patterns which exist only in the training set and not in the broader distribution.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vJpvQXJnOz"}],"key":"WxEzwMQB6i"}],"key":"ZSEcK4lLWT"},{"type":"heading","depth":2,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Identify Regularizer ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"h96kQNrRnp"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"Skq46FmzsS"}],"identifier":"identify-regularizer-lambda","label":"Identify Regularizer \\lambda","html_id":"identify-regularizer-lambda","implicit":true,"key":"mHUCFkhWoW"},{"type":"blockquote","position":{"start":{"line":15,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"image","url":"/cornell-notes/build/643c4fcd86a736a95208145a3a53f8ee.png","alt":"img","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"eDYIhy7yEo","urlSource":"https://www.cs.cornell.edu/courses/cs4780/2021fa/lectures/images/model_selection/13_1.png"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Figure 1: overfitting and underfitting. Note the x-axis is ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"QVoovYOyfH"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"tOB2zEOSti"},{"type":"text","value":":","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"GClCXwVxOK"}],"key":"fOuXCghTYg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"the bigger ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"pmlu5GyScI"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"lhqtoUNb3E"},{"type":"text","value":" is, the simpler the model is, so is likely to underfit.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"GOU4zZ6Hrq"}],"key":"WmUvAyBVAJ"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"the smaller ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ymxfqp7fpt"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"pWgR1g3p9k"},{"type":"text","value":" is, the more complex the model is, so is more likely to overfit","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mbMvybjzPh"}],"key":"NMPUke9Phs"}],"key":"C90s9WgDt2"}],"key":"x81EJxG6xW"},{"type":"heading","depth":3,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"K-Fold Cross Validation","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"KkvS0sJpf5"}],"identifier":"k-fold-cross-validation","label":"K-Fold Cross Validation","html_id":"k-fold-cross-validation","implicit":true,"key":"G1S4NihWns"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"When we train the data","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"wHQnbclBEs"}],"key":"iF85qBO4ss"},{"type":"text","value":", we can use the k-fold cross validation: divide the training data into ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ulQN0g2qdF"},{"type":"inlineMath","value":"k","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"p4uiMAwKMc"},{"type":"text","value":" partitions. Train on ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"w9PfxqWJO5"},{"type":"inlineMath","value":"k-1","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"wLMyeIHzXk"},{"type":"text","value":" of them and leave one out as validation set. Do this ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"hvep2QWf2m"},{"type":"inlineMath","value":"k","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"JCZQC91N9q"},{"type":"text","value":" times (i.e. leave out every partition exactly once) and average the validation error across runs. This gives you a good estimate of the validation error (even with standard deviation).","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"pux03kYoFZ"}],"key":"d1kOAAMrIg"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"In the extreme case, you can have ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"hW3rnsYp64"},{"type":"inlineMath","value":"k=n","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">k=n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"ZzMGksg7LL"},{"type":"text","value":", i.e. you only leave a single data point out (this is often referred to as LOOCV - Leave One Out Cross Validation). LOOCV is important if your data set is small and cannot afford to leave out many data points for evaluation.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"hfbGryl2Mm"}],"key":"tAwl3f7wON"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"We can also use k-fold cross validation solely to ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"AoYFS0JOMr"},{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"determine the hyperparameter ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"Ts1FAjAsFb"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"q6FK6hig4o"}],"key":"XqlhjAgN9P"},{"type":"text","value":": divide data into ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"PxVTkMolvg"},{"type":"inlineMath","value":"k","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"lmc2X9iCHp"},{"type":"text","value":" partitions, each with a specific ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"epsDtMGz54"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"gOuC6M4gNb"},{"type":"text","value":"; and we will select the ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"VHi8i4qjQW"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"m5wqL0fYlS"},{"type":"text","value":" that gives the best validation error.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"d4sa3ZgWpc"}],"key":"QW5UgqQqGb"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"No matter what we use k-fold for, after selecting the best model/parameter based on k-fold, we will have to train our model on the whole dataset for another time (remember we divided it into ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"VeaevHXwoK"},{"type":"inlineMath","value":"k-1","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"X9lyV3LgKM"},{"type":"text","value":" training set and ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"dsdbSZp8cs"},{"type":"text","value":"1","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"R0NvLB8zfJ"},{"type":"text","value":" validation set), and use that as our final model.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"KDbVbJIAME"}],"key":"XuAgFOFnFI"},{"type":"heading","depth":3,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Telescopic search","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"r5ZxTDd0ir"}],"identifier":"telescopic-search","label":"Telescopic search","html_id":"telescopic-search","implicit":true,"key":"EK039YIMMZ"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Do two searches:","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"ASqeECaOgC"}],"key":"pOhIWasnmT"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":36,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"find the best order of magnitude for ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"qTF131k6XS"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"Dd8fzyd9CL"},{"type":"text","value":". 先搜索数量级","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"EUtCJru0gH"}],"key":"bRTXkGU9hS"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"do a more fine-grained search around the best ","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"pxKeD3lwmp"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"nC6ZjeHl2L"},{"type":"text","value":" found so far. 再搜索此数量级下的最好值","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"rmpKUGUECI"}],"key":"xZJhgkShV6"}],"key":"A1Ncq0jt2M"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"For example, first you try ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"ptg7JsaRpJ"},{"type":"inlineMath","value":"\\lambda=0.01,0.1,1,10,100","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.01</mn><mo separator=\"true\">,</mo><mn>0.1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>10</mn><mo separator=\"true\">,</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda=0.01,0.1,1,10,100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0.01</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">10</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"b3CJUKWuhS"},{"type":"text","value":". It turns out 10 is the best performing value. Then you try out ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"PsvNv6VK6T"},{"type":"inlineMath","value":"\\lambda=5,10,15,20,25,...,95","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>5</mn><mo separator=\"true\">,</mo><mn>10</mn><mo separator=\"true\">,</mo><mn>15</mn><mo separator=\"true\">,</mo><mn>20</mn><mo separator=\"true\">,</mo><mn>25</mn><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mn>95</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda=5,10,15,20,25,...,95</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">10</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">15</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">20</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">25</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">95</span></span></span></span>","key":"qfpzYiOTTl"},{"type":"text","value":" to test values “around” ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"JKFTH9mnwT"},{"type":"text","value":"10","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"VUKqzOWw6z"},{"type":"text","value":".","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"HkWGlgoWdt"}],"key":"rqlxZfewVf"},{"type":"heading","depth":3,"position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Grid and Random search","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"McYy77P7EJ"}],"identifier":"grid-and-random-search","label":"Grid and Random search","html_id":"grid-and-random-search","implicit":true,"key":"RVF0OJN4Uk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":43,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Grid Search","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"pZUoqVgmmy"}],"key":"yRiStqUqTK"},{"type":"text","value":": If you have multiple parameters (e.g. ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"L99MklP7c4"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"SUy2so6pw7"},{"type":"text","value":" and also the kernel width ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"A7BBsNkjX0"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"yNwWy4TauV"},{"type":"text","value":" in case you are using a ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"Q6pbKQUkJa"},{"type":"link","url":"http://demo.showdownjs.com/lecturenote13.html","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"kernel","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"q0rYeSGFjK"}],"urlSource":"http://demo.showdownjs.com/lecturenote13.html","key":"C27wAVEkOB"},{"type":"text","value":") a simple way to find the best value of both of them is to fix a set of values for each hyper-parameter and try out every combination. 在 grid 上顺序选择","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"H6E6k20PwF"}],"key":"X3tR5YFWmg"},{"type":"listItem","spread":true,"position":{"start":{"line":44,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"strong","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Random Search","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"t35VBmvza0"}],"key":"sMXUXzM5ib"},{"type":"text","value":": Instead of selecting hyper-parameters on a pre-defined grid, we select them randomly within pre-defined intervals. 在区间(也可以理解成 grid)上随机选择","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"kdmFSMZ9MS"}],"key":"lJAO25UhQk"}],"key":"fNka35sOk9"},{"type":"blockquote","position":{"start":{"line":46,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"image","url":"/cornell-notes/build/2272771934d983e94c704e1643618f97.png","alt":"img","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"araqEu2aCE","urlSource":"https://www.cs.cornell.edu/courses/cs4780/2021fa/lectures/images/model_selection/gridrandom.png"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Figure 2: Grid Search vs Random search (red indicates lower loss, blue indicates high loss).","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"jGI78O4VHm"}],"key":"t6spYq0kXg"}],"key":"oD71oiRDDZ"},{"type":"heading","depth":2,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Early Stopping","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"s9dDxtKiiT"}],"identifier":"early-stopping","label":"Early Stopping","html_id":"early-stopping","implicit":true,"key":"GXu1dN3d9C"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Stop your optimization after M (>= 0) number of gradient steps, even if optimization has not converged yet, because our final model almost always overfits.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"fvTT8U1sZN"}],"key":"skUsxUgJMy"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"实际操作中，边训练边存模型，找到有最小 validation error 的模型（即我们不一定用最终的模型，相当于我们提早结束了训练)","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"FSreYVs0jt"}],"key":"w2jeobT5qn"},{"type":"blockquote","position":{"start":{"line":56,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"image","url":"/cornell-notes/build/92fd34b83f37bc2dba6d863955f3b666.png","alt":"img","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"qtMEOspLQK","urlSource":"https://www.cs.cornell.edu/courses/cs4780/2021fa/lectures/images/model_selection/13_2.png"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Figure 3: Early stopping，注意这里和前图 1 不一样，横轴是 M","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"EjQySRpCB7"}],"key":"FbkUh2eX1X"}],"key":"gPh8mp0VZw"}],"key":"B18ppCJnau"}],"key":"dJyibsUacU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Bias-Variance Tradeoff","url":"/2021-10-26-bias-variance-tradeoff","group":"CS4780 Intro to Machine Learning"},"next":{"title":"Kernels","url":"/2021-11-02-kernels","group":"CS4780 Intro to Machine Learning"}}},"domain":"http://localhost:3000"}